


;;; This is all about Table 11.2 in [PBCS]
;;; All calculations redone with CSP-Rules-V2.0


(defglobal ?*TE-B2* = (create$
    ;;; rien entre 1 et 1000
    ;;; 11 entre 1001 et 2000
    1159 1247 1697 1700 1713 1762 1797 1804 1835 1853 1867
    
;;;;;;;;; 1st 100s of each SER slice
    ;;; 4 entre 1686 et 1785 inclus (1762 is new)
    1697 1700 1713 1762
    ;;; 9 entre 3375 et 3474 inclus
    3383 3404 3405 3408 3409 3415 3434 3446 3453
    ;;; 24 entre 6031 et 6130 inclus (6067 is new)
    6038 6040 6041 6048 6051 6053 6055 6058 6061 6062 6064 6066 6067 6069 6072 6076 6077 6082 6088 6101 6117 6125 6126 6130
    ;;; 71 entre 7849 et 7948 inclus (7856 is new)
    7849 7850 7852 7853 7855 7856 7857 7858 7859 7860 7861 7863 7865 7866 7868 7870 7874 7877 7879 7880 7881 7882 7884 7885 7887 7888 7889 7890 7891 7892 7893 7894 7895 7896 7897 7899 7900 7901 7902 7903 7904 7905 7907 7909 7911 7913 7915 7917 7918 7921 7922 7923 7925 7927 7929 7930 7932 7933 7934 7935 7936 7937 7938 7939 7940 7941 7944 7945 7946 7947 7948
    ;;; 23 entre 10276 et 10375 inclus (10311 is new)
    10298 10304 10307 10308 10311 10315 10319 10321 10325 10328 10333 10341 10344 10346 10348 10351 10355 10356 10358 10362 10364 10368 10372
    ;;; 33 entre 13207 et 13306 inclus (13216 is new)
    13208 13210 13213 13214 13216 13217 13218 13226 13227 13230 13234 13237 13239 13240 13242 13247 13248 13250 13251 13253 13254 13255 13257 13263 13264 13266 13270 13274 13278 13282 13291 13293 13295
    ;;; 51 entre 17813 et 17912 inclus (17825 is new
    17815 17816 17817 17819 17822 17823 17824 17825 17826 17828 17829 17832 17836 17839 17840 17844 17846 17847 17850 17851 17854 17855 17859 17864 17865 17868 17869 17870 17871 17872 17873 17874 17875 17877 17878 17881 17888 17890 17892 17894 17896 17897 17898 17899 17900 17902 17903 17904 17906 17908 17910
))


(defglobal ?*TE-[B2]+B3* = (create$
    ;;; 118 entre 1 et 1000 (#588 added)
    114 117 124 150 153 160 188 205 208 223 227 234 236 252 253 255 256 272 291 294 295 302 329 332 334 339 348 356 358 360 361 362 363 368 384 399 426 434 443 446 461 462 466 472 482 484 495 499 504 505 513 517 522 524 527 530 532 538 544 548 551 556 561 562 563 564 567 576 580 585 586 587 588 590 600 602 614 630 632 636 650 665 700 702 717 718 724 725 732 749 750 753 755 763 772 787 817 827 828 836 841 843 860 864 878 882 901 928 939 944 948 952 963 969 979 982 992 997
    
;;;;;;;;; 1st 100s
    ;;; 0 entre 1 et 4 inclus
    ;;; 0 entre 5 et 24 inclus
    ;;; 0 entre 25 et 58 inclus
    ;;; 0 entre 59 et 106 inclus
    ;;; 9 entre 107 et 215 inclus
    114 117 124 150 153 160 188 205 208
    ;;; 35 entre 216 et 478 inclus
    223 227 234 236 252 253 255 256 272 291 294 295 302 329 332 334 339 348 356 358 360 361 362 363 368 384 399 426 434 443 446 461 462 466 472
;;;;;;;;; 1st 100s
    ;;; 24 entre 479 et 578 inclus
    482 484 495 499 504 505 513 517 522 524 527 530 532 538 544 548 551 556 561 562 563 564 567 576
    ;;; 44 entre 1686 et 1785 inclus (1762 missing, because in B2B)
    1686 1688 1689 1690 1692 1693 1694 1695 1698 1699 1701 1702 1704 1706 1710 1711 1712 1717 1723 1726 1731 1738 1742 1743 1744 1746 1747 1748 1749 1751 1753 1756 1760 1761 1763 1764 1767 1768 1770 1773 1774 1775 1781 1782
    ;;; 61 entre 3375 et 3474 inclus
    3375 3376 3377 3378 3379 3380 3382 3384 3385 3386 3387 3388 3389 3390 3391 3392 3395 3396 3399 3403 3406 3407 3410 3412 3413 3414 3416 3418 3421 3422 3423 3424 3425 3426 3429 3432 3433 3435 3436 3437 3438 3440 3443 3444 3447 3448 3449 3450 3451 3452 3454 3455 3457 3459 3461 3464 3465 3466 3467 3470 3472
    ;;; 69 entre 6031 et 6130 inclus
    6031 6032 6034 6035 6036 6037 6039 6042 6043 6044 6045 6046 6047 6050 6052 6054 6056 6057 6059 6060 6063 6065 6068 6070 6071 6073 6074 6075 6078 6079 6080 6081 6083 6084 6085 6086 6087 6089 6090 6091 6092 6093 6094 6095 6096 6098 6099 6100 6102 6104 6105 6107 6108 6109 6110 6111 6112 6113 6114 6115 6116 6118 6119 6121 6122 6123 6127 6128 6129
    ;;; 22 entre 7849 et 7948 inclus
    7851 7854 7862 7864 7869 7871 7872 7873 7875 7876 7878 7883 7898 7906 7908 7910 7912 7914 7916 7920 7924 7942
    ;;; 48 entre 10276 et 10375 inclus
    10276 10277 10278 10279 10280 10281 10282 10283 10285 10286 10287 10290 10291 10294 10295 10296 10297 10300 10305 10306 10309 10310 10313 10314 10317 10324 10326 10330 10331 10334 10336 10338 10340 10342 10343 10345 10347 10349 10353 10354 10357 10359 10361 10363 10365 10371 10374 10375
    ;;; 53 entre 13207 et 13306 inclus (same)
    13207 13209 13212 13215 13220 13222 13223 13224 13225 13228 13232 13233 13235 13236 13241 13243 13245 13246 13249 13252 13260 13261 13262 13265 13267 13271 13272 13273 13275 13276 13277 13279 13280 13281 13283 13284 13285 13286 13287 13288 13289 13290 13292 13294 13296 13298 13299 13300 13301 13302 13303 13304 13305
    ;;; 45 entre 17813 et 17912 inclus
    17813 17814 17818 17820 17821 17827 17830 17831 17833 17834 17835 17837 17838 17841 17842 17843 17848 17849 17852 17853 17856 17857 17858 17860 17861 17862 17863 17866 17867 17876 17879 17880 17882 17884 17885 17886 17887 17889 17891 17893 17901 17905 17909 17911 17912
))




(defglobal ?*TE-[B3]+B4* = (create$
    ;;; 0 entre 1 et 4 inclus
    ;;; 1 entre 5 et 24 inclus
    7
    ;;; 4 entre 25 et 58 inclus
    33 36 42 58
    ;;; 17 entre 59 et 106 inclus
    60 61 62 63 67 71 74 75 76 77 82 83 96 101 104 105 106
    ;;; 57 entre 107 et 215 inclus
    107 108 110 111 112 113 116 118 119 120 123 125 127 128 129 132 133 134 137 139 140 142 146 147 151 152 157 158 159 162 163 166 167 168 169 170 173 178 180 181 182 183 184 185 190 192 193 194 196 198 200 202 206 209 211 212 213
    ;;; 131 entre 216 et 478 inclus
    216 217 219 220 221 222 224 225 228 229 231 232 238 239 240 243 245 246 247 248 249 250 251 254 258 259 260 265 266 269 270 274 275 276 277 278 282 283 284 286 292 293 297 298 301 306 310 311 314 318 319 320 322 323 326 328 331 333 336 337 340 341 347 350 351 353 354 366 367 373 374 376 377 379 382 385 386 387 388 389 390 392 395 398 400 401 402 403 404 405 406 408 409 410 411 412 413 415 417 419 420 421 423 424 425 427 428 429 430 433 435 438 439 440 442 445 451 454 457 458 459 460 464 467 468 469 470 471 474 476 478
;;;;;;;;; 1st 100s
    ;;; 64 entre 479 et 578 inclus
    479 480 481 483 485 486 487 488 489 490 491 492 493 494 496 497 498 500 501 503 506 507 508 509 510 511 512 514 516 518 520 521 523 525 526 528 533 535 537 539 540 541 542 543 545 546 547 549 552 553 554 555 557 558 559 560 565 569 570 571 572 573 577 578
    ;;; 44 entre 1686 et 1785 inclus
    1687 1691 1696 1703 1705 1707 1708 1709 1714 1715 1716 1718 1719 1721 1722 1724 1727 1728 1729 1730 1733 1734 1735 1736 1737 1739 1740 1741 1745 1750 1754 1757 1758 1759 1765 1766 1771 1772 1776 1778 1779 1780 1783 1784
    ;;; 29 entre 3375 et 3474 inclus
    3381 3393 3394 3398 3400 3401 3402 3411 3417 3419 3420 3427 3428 3430 3431 3439 3441 3442 3445 3456 3458 3460 3462 3463 3468 3469 3471 3473 3474
    ;;; 7 entre 6031 et 6130 inclus
    6033 6049 6097 6103 6106 6120 6124
    ;;; 7 entre 7849 et 7948 inclus (same)
    7867 7886 7919 7926 7928 7931 7943
    ;;; 28 entre 10276 et 10375 inclus
    10288 10289 10292 10293 10299 10301 10302 10303 10312 10316 10318 10320 10322 10323 10327 10329 10332 10335 10337 10339 10350 10352 10360 10366 10367 10369 10370 10373
    ;;; 14 entre 13207 et 13306 inclus
    13211 13219 13221 13229 13231 13238 13244 13256 13258 13259 13268 13269 13297 13306
    ;;; 4 entre 17813 et 17912 inclus
    17845 17883 17895 17907
))



(defglobal ?*TE-[B4]+B5* = (create$
    ;;; 3 entre 1 et 4 inclus
    1 2 4
    ;;; 9 entre 5 et 24 inclus
    6 8 9 10 12 14 18 19 21
    ;;; 20 entre 25 et 58 inclus
    25 28 31 32 35 37 38 39 40 41 43 44 47 48 49 50 51 52 56 57
    ;;; 27 entre 59 et 106 inclus
    59 64 65 66 68 69 70 72 73 78 79 80 81 84 86 87 88 89 90 91 92 93 94 95 97 98 102
    ;;; 42 entre 107 et 215 inclus
    109 115 121 122 126 130 131 135 136 138 141 143 144 145 148 149 154 155 156 161 164 165 171 172 174 175 177 179 186 187 189 191 195 197 199 201 203 204 207 210 214 215
    ;;; 88 entre 216 et 478 inclus
    218 226 230 233 235 237 241 242 244 257 261 262 263 264 267 268 271 273 279 280 281 285 288 290 296 299 300 303 304 305 307 308 309 312 313 315 316 317 321 324 325 327 330 338 343 344 345 346 352 355 359 364 369 370 371 372 375 378 380 381 383 393 394 396 397 407 414 416 418 422 431 432 436 437 444 447 448 449 450 452 453 455 456 463 465 473 475 477
    ;;; 12 entre 479 et 578 inclus
    502 515 519 529 531 534 536 550 566 568 574 575
    ;;; 8 entre 1686 et 1785 inclus
    1720 1725 1732 1752 1755 1769 1777 1785
    ;;; 1 entre 3375 et 3474 inclus
    3397
    ;;; 0 entre 6031 et 6130 inclus
    ;;; 0 entre 7849 et 7948 inclus
    ;;; 0 entre 10276 et 10375 inclus
    10284
    ;;; 0 entre 13207 et 13306 inclus
    ;;; 0 entre 17813 et 17912 inclus
))


(defglobal ?*TE-[B5]+B6* = (create$
    ;;; 1 entre 1 et 4 inclus
    3
    ;;; 9 entre 5 et 24 inclus
    5 11 13 15 16 17 20 23 24
    ;;; 10 entre 25 et 58 inclus
    26 27 29 30 34 45 46 53 54 55
    ;;; 4 entre 59 et 106 inclus
    85 99 100 103
    ;;; 1 entre 107 et 215 inclus
    176
    ;;; 9 entre 216 et 478 inclus
    287 289 335 342 349 357 365 391 441
    ;;; 0 entre 479 et 578 inclus
    ;;; 0 entre 1686 et 1785 inclus
    ;;; 0 entre 3375 et 3474 inclus
    ;;; 0 entre 6031 et 6130 inclus
    ;;; 0 entre 7849 et 7948 inclus
    ;;; 0 entre 10276 et 10375 inclus
    ;;; 0 entre 13207 et 13306 inclus
    ;;; 0 entre 17813 et 17912 inclus
))


(defglobal ?*TE-[B6]+B7* = (create$
     22
))




(deffunction find-rating(?i)
    (if (member$ ?i ?*TE-B2*) then (return 2))
    (if (member$ ?i ?*TE-[B2]+B3*) then (return 3))
    (if (member$ ?i ?*TE-[B3]+B4*) then (return 4))
    (if (member$ ?i ?*TE-[B4]+B5*) then (return 5))
    (if (member$ ?i ?*TE-[B5]+B6*) then (return 6))
    (if (member$ ?i ?*TE-[B6]+B7*) then (return 7)
        else (return 99))
)

(deffunction fill-ratings-file(?rat-file)
    (open ?rat-file "rat-file" "w")
    ;;; SER 11.9
    (loop-for-count (?i 1 4) (printout "rat-file" (find-rating ?i) crlf))
    ;;; SER 11.8
    (loop-for-count (?i 5 24) (printout "rat-file" (find-rating ?i) crlf))
    ;;; SER 11.7
    (loop-for-count (?i 25 58) (printout "rat-file" (find-rating ?i) crlf))
    ;;; SER 11.6
    (loop-for-count (?i 59 106) (printout "rat-file" (find-rating ?i) crlf))
    ;;; SER 11.5
    (loop-for-count (?i 107 215) (printout "rat-file" (find-rating ?i) crlf))
    ;;; SER 11.4
    (loop-for-count (?i 216 478) (printout "rat-file" (find-rating ?i) crlf))
    ;;; SER 11.3
    (loop-for-count (?i 479 578) (printout "rat-file" (find-rating ?i) crlf))
    ;;; SER 11.2
    (loop-for-count (?i 1686 1785) (printout "rat-file" (find-rating ?i) crlf))
    ;;; SER 11.1
    (loop-for-count (?i 3375 3474) (printout "rat-file" (find-rating ?i) crlf))
    ;;; SER 11.0
    (loop-for-count (?i 6031 6130) (printout "rat-file" (find-rating ?i) crlf))
    ;;; SER 10.9
    (loop-for-count (?i 7849 7948) (printout "rat-file" (find-rating ?i) crlf))
    ;;; SER 10.8
    (loop-for-count (?i 10276 10375) (printout "rat-file" (find-rating ?i) crlf))
    ;;; SER 10.7
    (loop-for-count (?i 13207 13306) (printout "rat-file" (find-rating ?i) crlf))
    ;;; SER 10.6
    (loop-for-count (?i 17813 17912) (printout "rat-file" (find-rating ?i) crlf))
    (close "rat-file")
)

        
;;; (+ 578 (* 7 100)) = 1278 test puzzles
